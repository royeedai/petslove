import{r as a,o as t,k as s,c as e,w as l,i as c,a as u,b as o,h as n,j as d,t as i,l as r,d as f,F as _,e as m,m as p,p as v,g,q as b,s as k,u as y,v as h}from"./index-DsnV_1T9.js";import{_ as x,r as j}from"./_plugin-vue_export-helper.DGOf1M-5.js";const w=x({__name:"list",setup(x){const w=a(0),C=a(0),L=a(0),T=a("all"),D=a([{label:"å…¨éƒ¨",value:"all",emoji:"ğŸ“‹"},{label:"å¾…æ•‘åŠ©",value:"pending",emoji:"ğŸ†˜"},{label:"æ•‘åŠ©ä¸­",value:"processing",emoji:"ğŸƒ"},{label:"å·²å®Œæˆ",value:"completed",emoji:"âœ…"}]),M=a([]);t(()=>{$(),q()}),s(T,()=>{$()});const $=async()=>{try{const a={page:1,size:20};"all"!==T.value&&(a.status=T.value);const t=await j.getTaskList(a);t.data&&t.data.records&&(M.value=t.data.records.map(a=>({...a,cover:a.cover||"https://images.unsplash.com/photo-1583511655857-d19b40a7a54e?w=600&q=80"})))}catch(a){console.error("åŠ è½½æ•‘åŠ©ä»»åŠ¡åˆ—è¡¨å¤±è´¥",a)}},q=async()=>{try{const a=await j.getTaskList({page:1,size:100});if(a.data&&a.data.records){const t=a.data.records;w.value=t.filter(a=>"pending"===a.status||"processing"===a.status).length,C.value=t.filter(a=>"completed"===a.status).length,L.value=128}}catch(a){console.error("åŠ è½½ç»Ÿè®¡æ•°æ®å¤±è´¥",a)}},z=()=>{y({title:"å‘å¸ƒé¡µé¢å¼€å‘ä¸­",icon:"none"})},F=a=>{if(!a)return"åˆšåˆš";const t=new Date,s=new Date(a),e=t-s,l=Math.floor(e/1e3/60);if(l<1)return"åˆšåˆš";if(l<60)return`${l}åˆ†é’Ÿå‰`;const c=Math.floor(l/60);if(c<24)return`${c}å°æ—¶å‰`;const u=Math.floor(c/24);return u<7?`${u}å¤©å‰`:s.toLocaleDateString()};return(a,t)=>{const s=n,x=c,q=r,I=g,N=b;return u(),e(x,{class:"page"},{default:l(()=>[o(x,{class:"stats-bar"},{default:l(()=>[o(x,{class:"stat-item"},{default:l(()=>[o(s,{class:"stat-icon"},{default:l(()=>[d("ğŸ†˜")]),_:1}),o(x,{class:"stat-info"},{default:l(()=>[o(s,{class:"stat-value"},{default:l(()=>[d(i(w.value),1)]),_:1}),o(s,{class:"stat-label"},{default:l(()=>[d("æ•‘åŠ©ä¸­")]),_:1})]),_:1})]),_:1}),o(x,{class:"stat-divider"}),o(x,{class:"stat-item"},{default:l(()=>[o(s,{class:"stat-icon"},{default:l(()=>[d("âœ…")]),_:1}),o(x,{class:"stat-info"},{default:l(()=>[o(s,{class:"stat-value"},{default:l(()=>[d(i(C.value),1)]),_:1}),o(s,{class:"stat-label"},{default:l(()=>[d("å·²å®Œæˆ")]),_:1})]),_:1})]),_:1}),o(x,{class:"stat-divider"}),o(x,{class:"stat-item"},{default:l(()=>[o(s,{class:"stat-icon"},{default:l(()=>[d("ğŸ‘¥")]),_:1}),o(x,{class:"stat-info"},{default:l(()=>[o(s,{class:"stat-value"},{default:l(()=>[d(i(L.value),1)]),_:1}),o(s,{class:"stat-label"},{default:l(()=>[d("å¿—æ„¿è€…")]),_:1})]),_:1})]),_:1})]),_:1}),o(q,{"scroll-x":"",class:"status-scroll"},{default:l(()=>[o(x,{class:"status-list"},{default:l(()=>[(u(!0),f(_,null,m(D.value,(a,t)=>(u(),e(x,{key:t,class:p(["status-item",{active:T.value===a.value}]),onClick:t=>T.value=a.value},{default:l(()=>[o(s,{class:"status-emoji"},{default:l(()=>[d(i(a.emoji),1)]),_:2},1024),o(s,{class:"status-text"},{default:l(()=>[d(i(a.label),1)]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]),_:1})]),_:1}),o(x,{class:"rescue-list"},{default:l(()=>[(u(!0),f(_,null,m(M.value,a=>(u(),e(x,{key:a.id,class:"rescue-card",onClick:a=>{y({title:"è¯¦æƒ…é¡µé¢å¼€å‘ä¸­",icon:"none"})}},{default:l(()=>["urgent"===a.urgencyLevel?(u(),e(x,{key:0,class:"urgent-tag"},{default:l(()=>[o(s,{class:"urgent-icon"},{default:l(()=>[d("ğŸš¨")]),_:1}),o(s,{class:"urgent-text"},{default:l(()=>[d("ç´§æ€¥æ±‚åŠ©")]),_:1})]),_:1})):v("",!0),o(I,{src:a.cover,mode:"aspectFill",class:"rescue-image"},null,8,["src"]),o(x,{class:"rescue-content"},{default:l(()=>[o(s,{class:"rescue-title"},{default:l(()=>[d(i(a.title),1)]),_:2},1024),o(x,{class:"rescue-meta"},{default:l(()=>[o(x,{class:"meta-row"},{default:l(()=>[o(x,{class:"meta-item"},{default:l(()=>[o(s,{class:"meta-icon"},{default:l(()=>[d("ğŸ“")]),_:1}),o(s,{class:"meta-text"},{default:l(()=>[d(i(a.address),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),o(x,{class:"meta-row"},{default:l(()=>[o(x,{class:"meta-item"},{default:l(()=>[o(s,{class:"meta-icon"},{default:l(()=>[d("â°")]),_:1}),o(s,{class:"meta-text"},{default:l(()=>[d(i(F(a.createTime)),1)]),_:2},1024)]),_:2},1024),o(x,{class:"meta-item"},{default:l(()=>[o(s,{class:"meta-icon"},{default:l(()=>[d("ğŸ‘¤")]),_:1}),o(s,{class:"meta-text"},{default:l(()=>[d(i(a.reporterName),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),o(x,{class:"rescue-desc"},{default:l(()=>[d(i(a.description),1)]),_:2},1024),o(x,{class:"rescue-footer"},{default:l(()=>[o(x,{class:p(["status-badge",a.status])},{default:l(()=>[o(s,{class:"status-dot"}),o(s,{class:"status-text"},{default:l(()=>{return[d(i((t=a.status,{pending:"å¾…æ•‘åŠ©",processing:"æ•‘åŠ©ä¸­",completed:"å·²å®Œæˆ",cancelled:"å·²å–æ¶ˆ"}[t]||"æœªçŸ¥")),1)];var t}),_:2},1024)]),_:2},1032,["class"]),o(x,{class:"action-group"},{default:l(()=>["pending"===a.status?(u(),e(N,{key:0,class:"btn-participate",onClick:k(t=>(async a=>{h({title:"ç¡®è®¤å‚ä¸",content:"ç¡®å®šè¦å‚ä¸è¿™ä¸ªæ•‘åŠ©ä»»åŠ¡å—ï¼Ÿ",success:async t=>{if(t.confirm)try{await j.acceptTask(a.id),y({title:"å‚ä¸æˆåŠŸ",icon:"success"}),$()}catch(s){console.error("å‚ä¸æ•‘åŠ©å¤±è´¥",s)}}})})(a),["stop"])},{default:l(()=>[o(s,{class:"btn-icon"},{default:l(()=>[d("ğŸ™‹")]),_:1}),o(s,{class:"btn-text"},{default:l(()=>[d("æˆ‘è¦å‚ä¸")]),_:1})]),_:2},1032,["onClick"])):"processing"===a.status?(u(),e(N,{key:1,class:"btn-detail",onClick:k(a=>{y({title:"è¿›åº¦é¡µé¢å¼€å‘ä¸­",icon:"none"})},["stop"])},{default:l(()=>[o(s,{class:"btn-icon"},{default:l(()=>[d("ğŸ“Š")]),_:1}),o(s,{class:"btn-text"},{default:l(()=>[d("æŸ¥çœ‹è¿›åº¦")]),_:1})]),_:2},1032,["onClick"])):v("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),0===M.value.length?(u(),e(x,{key:0,class:"empty-state"},{default:l(()=>[o(s,{class:"empty-icon"},{default:l(()=>[d("ğŸ”")]),_:1}),o(s,{class:"empty-text"},{default:l(()=>[d("æš‚æ— æ•‘åŠ©ä»»åŠ¡")]),_:1}),o(s,{class:"empty-desc"},{default:l(()=>[d("æœŸå¾…æ‚¨çš„çˆ±å¿ƒå‚ä¸")]),_:1})]),_:1})):v("",!0)]),_:1}),o(x,{class:"fab-btn",onClick:z},{default:l(()=>[o(s,{class:"fab-icon"},{default:l(()=>[d("ğŸ“")]),_:1})]),_:1})]),_:1})}}},[["__scopeId","data-v-f2bebfbe"]]);export{w as default};
